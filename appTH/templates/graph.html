<!DOCTYPE html>
{% load static %}

<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>우정바이오 온습도계</title>
    <link href="{% static '/css/main.css' %}" rel="stylesheet" type="text/css">
    <link media="all" href="{% static 'js/nv.d3.css' %}" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="{% static 'js/d3.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/nv.d3.min.js' %}"></script>
    <script src="{% static 'js/stream_layers.js' %}"></script>

    <style>
        text {
            font: 12px sans-serif;
        }
        svg {
            display: block;
        }
        #chart, svg {
            margin: 0px;
            padding: 0px;
            height: 450px;
            width: 100%;
        }
    </style>
</head>
<body>
<a href="{% url 'home' %}"><img class="logo" src="{% static '/images/KS.jpg' %}"></a>
<h1 class="title1">감염관리사업부 온습도계 분석</h1>

<div class="result">
    <a href="{% url 'graph' %}"><button class="btn-re">새로고침</button></a>
    <p class="title2">온습도 그래프</p>
</div>

<div id="chart" class='with-3d-shadow with-transitions'>
    <svg></svg>
</div>

<script type="text/javascript">

    nv.addGraph(function() {
        var chart = nv.models.lineWithFocusChart();
	
	var dataList = new Array();
	var dataList2 = new Array();
	
	{% for th in th_list %}
	    var data = new Object() ;
	    data.x = {{th.run_time}}
	    data.y = {{th.humidity}}
	    data.series = 0
	    dataList.push(data);
	    
	    var data2 = new Object() ;
	    data2.x = {{th.run_time}}
	    data2.y = {{th.temperature}}
	    data2.series = 1
	    dataList2.push(data2);
	{% endfor %}
	
	var th_data = [
	  {
	    "key": "습도(%)",
	    "color": "#00ace6",
	    "values": dataList
	  },
	  {
	    "key": "온도(°C)",
	    "color": "#ff5c33",
	    "values": dataList2
	  }
	]
	
    
        chart.xAxis.tickFormat(d3.format(',f')).axisLabel("시간(초)");
        chart.x2Axis.tickFormat(d3.format(',f'));

        chart.yTickFormat(d3.format(',.2f'));

        chart.useInteractiveGuideline(true);

        d3.select('#chart svg')
            .datum(th_data)
            .call(chart);

        nv.utils.windowResize(chart.update);

        return chart;
    });

</script>
</body>
</html>

